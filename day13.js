function sortCarts(carts) {
    return carts.sort((a, b) => (a.pos.y == b.pos.y) ? (a.pos.x - b.pos.x) : (a.pos.y - b.pos.y));
}

function parseInput(input) {
    map = input.split('\n').map(a => a.split(''));

    carts = [];

    for (let y = 0; y < map.length; y++) {
        for (let x = 0; x < map[y].length; x++) {
            if (map[y][x].match(/[\^<>v]/)) {
                if (map[y][x] == '>') {
                    carts.push({
                        cart: '>',
                        dire: {
                            x: 1,
                            y: 0
                        },
                        pos: {
                            x: x,
                            y: y,
                        },
                        nextTurn: "left",
                        track: '-'
                    });
                    continue;
                }
                else if (map[y][x] == '<') {
                    carts.push({
                        cart: '<',
                        dire: {
                            x: -1,
                            y: 0
                        },
                        pos: {
                            x: x,
                            y: y,
                        },
                        nextTurn: "left",
                        track: '-'
                    });
                    continue;
                }
                else if (map[y][x] == '^') {
                    carts.push({
                        cart: '^',
                        dire: {
                            x: 0,
                            y: -1
                        },
                        pos: {
                            x: x,
                            y: y,
                        },
                        nextTurn: "left",
                        track: '|'
                    });
                    continue;
                }
                else if (map[y][x] == 'v') {
                    carts.push({
                        cart: 'v',
                        dire: {
                            x: 0,
                            y: 1
                        },
                        pos: {
                            x: x,
                            y: y,
                        },
                        nextTurn: "left",
                        track: '|'
                    });
                    continue;
                }
            }
        }
    }

    return {
        map: map,
        carts: sortCarts(carts),
        collision:false
    }
}

function drawCar(dX, dY) {
    if (dX > 0) {
        return '>';
    } else if (dX < 0) {
        return '<';
    } else {
        return (dY > 0) ? 'v' : '^';
    }
}

function cartIndex(carts,x,y){
	for(let [index,cart] of carts.entries()){
		if(cart.pos.x==x && cart.pos.y==y) return index;
	}
	return -1;
}

function tick(state) {
	let crashed=[]

    for (let [index, c] of state.carts.entries()) {
    	currMap = JSON.parse(JSON.stringify(state.map));
        let cart = JSON.parse(JSON.stringify(c));

    	if(crashed.includes(index)){
    		state.map[cart.pos.y][cart.pos.x] = cart.track;
    		continue;
    	}

        //collision case
        if (currMap[cart.pos.y + cart.dire.y][cart.pos.x + cart.dire.x].match(/[\^<>v]/)) {
            console.log("Collision at (" + (cart.pos.x + cart.dire.x) + "," + (cart.pos.y + cart.dire.y) + ")");
            state.map[cart.pos.y][cart.pos.x] = cart.track;
            state.collision=true;
            crashed.push(index);

            crashee=cartIndex(state.carts,(cart.pos.x + cart.dire.x),(cart.pos.y + cart.dire.y))
            state.map[state.carts[crashee].pos.y][state.carts[crashee].pos.x]=state.carts[crashee].track;

            crashed.push(crashee);
        }
        else {
            state.map[cart.pos.y][cart.pos.x] = cart.track;
        	cart.track=currMap[cart.pos.y + cart.dire.y][cart.pos.x + cart.dire.x];

            if (currMap[cart.pos.y + cart.dire.y][cart.pos.x + cart.dire.x] == '\\') {
                state.carts[index] = {
                    ...cart,
                    dire: {
                        x: cart.dire.y,
                        y: cart.dire.x
                    }
                }
            }
            else if (currMap[cart.pos.y + cart.dire.y][cart.pos.x + cart.dire.x] == '/') {
                state.carts[index] = {
                    ...cart,
                    dire: {
                        x: -cart.dire.y,
                        y: -cart.dire.x
                    }
                }
            }
            else if (currMap[cart.pos.y + cart.dire.y][cart.pos.x + cart.dire.x] == '+') {
                switch (cart.nextTurn) {
                    case "left": state.carts[index] = {
                        ...cart,
                        dire: {
                            x: cart.dire.y == 0 ? 0 : cart.dire.y,
                            y: cart.dire.x == 0 ? 0 : -cart.dire.x
                        },
                        nextTurn: "straight"
                    };
                        break;
                    case "straight": state.carts[index] = {
                        ...cart,
                        nextTurn: "right"
                    };
                        break;
                    case "right": state.carts[index] = {
                        ...cart,
                        dire: {
                            x: cart.dire.y == 0 ? 0 : -cart.dire.y,
                            y: cart.dire.x == 0 ? 0 : cart.dire.x
                        },
                        nextTurn: "left"
                    };
                        break;
                }
            }
            state.carts[index].pos = {
                x: cart.pos.x + cart.dire.x,
                y: cart.pos.y + cart.dire.y
            };
            
            state.carts[index].cart = drawCar(state.carts[index].dire.x, state.carts[index].dire.y);
            state.carts[index].track = cart.track;
            state.map[cart.pos.y + cart.dire.y][cart.pos.x + cart.dire.x] = state.carts[index].cart;
        }
    }

    for(let rip of crashed.sort().reverse()){
    	state.carts.splice(rip,1);
    }

    return state;
}

function part1(input){
	state = parseInput(input);
	while(!state.collision){
		state = tick(state);
		state.carts=sortCarts(state.carts);
	}
	console.log();
	console.log(state.map.map(a=>a.join('')).join('\n'));
    console.log();
}

function part2(input){
	state = parseInput(input);

	console.log(state.carts.length+" cars left!");

	while(state.carts.length>1){

		state = tick(state);
		state.carts=sortCarts(state.carts);

		if(state.collision){
			state.collision=false;
			console.log(state.carts.length+" cars left!");
		}
		//console.log();
		//console.log(state.map.map(a=>a.join('')).join('\n'));
	    //console.log();
	    //console.log(state.carts.map(a=>"("+a.pos.x+","+a.pos.y+")").join(','));
	}
	console.log("Cart left at: ("+state.carts[0].pos.x+","+state.carts[0].pos.y+")");
}


/*input=`/>-<\\  
|   |  
| /<+-\\
| | | v
\\>+</ ^
  |   |
  \\<->/`*/

input = `                    /--------------------------------------------------\\                                        /----------------\\                    
          /---------+--------------------------------------------------+-------------\\                          |                |/-------------\\     
          |   /-----+---------------------------------\\                |          /--+--------------------------+-------\\        ||             |     
          |   |     |                                 |        /-------+----------+--+--------------------------+-------+---\\    ||             |     
          |   |     |              /------------------+--------+-------+\\         |  |                          |       |   |    ||             |     
          |   |     |    /---------+------------------+--------+--\\    ||         |  |                    /-----+-------+---+----++-------------+---\\ 
          |   |     |    |         |                  |        |  |    ||         |  |                    |     |       |   |    ||             |   | 
        /-+---+-----+----+---\\     |                  |        |  |    ||         |/-+--------------------+-----+-------+---+----++-------------+\\  | 
        | |   |     |    |   |     |   /--------------+--------+--+----++---------++-+--------------------+-----+------\\|   |    ||             ||  | 
        | |/--+-----+----+---+-----+---+--------------+--------+--+----++\\        || |                    |     |      ||   |    ||             ||  | 
        | ||  |     |    |   |     |   |              |        |  |   /+++--------++-+--------------------+\\    |      ||   |    ||             ||  | 
        | ||  |   /-+----+---+-----+---+--------------+--\\     |  |   ||||        || |  /-----------------++\\   |      ||   |    ||             ||  | 
        | || /+---+-+--\\ |   |     |   |              |  |     |  |   ||||        || |  |                 |||   |      ||   |    ||             ||  | 
      /-+-++-++---+-+--+-+---+-----+---+--------------+--+-----+--+---++++--------++-+--+----------\\      |||   |      ||   |    ||             ||  | 
      | | || ||   | |  | |   |     |/--+--------------+\\ |     |  |   ||||        || |  |          |      |||   |      ||   |    |\\-------------/|  | 
      | | || ||   | |  | |   |/----++--+--------------++-+-----+--+---++++--------++-+--+----------+---\\  |||   |      ||   |    |               |  | 
      | | || ||  /+-+--+-+---++----++--+--------------++-+-----+--+---++++--------++-+--+----------+---+--+++\\  |      ||   |    |               |  | 
      | | || ||  || |  | |   ||    ||  |       /------++-+-----+--+---++++--------++-+--+----------+---+--++++--+---\\  ||   |    |               |  | 
      | | || ||  || |  | |   ||    ||  |       |      || |     |  |   ||||        || |  |          |   |  ||||  |   |  ||   |    |               |  | 
      | | || ||  || |  | |   ||    || /+-------+------++-+-----+--+---++++---->---++-+--+----------+---+--++++--+---+--++---+-\\  |               |  | 
      | | || ||  || |  | |   ||    || ||       |      || |     |  |   ||||        || |  |          |   |  ||||  |   |  ||   | |  |               |  | 
      | | || ||  || |  | |   ||    || ||       |      || |     |  |   ||||        || |  |          |   |  ||||  |   |  ||   | |  |               |  | 
      | | ||/++--++-+--+-+---++\\   || ||       |      || |     |  |   ||||        || |  |          |   |  ||||  |   |  ||   | |  |               |  | 
     /+-+-+++++\\ || |  | |   |||   || ||       |      || |/----+--+---++++--------++-+--+----------+---+--++++--+---+--++---+-+-\\|               |  | 
 /---++-+-++++++-++-+--+-+---+++---++-++----->-+------++-++----+--+---++++--------++\\|  |    /-----+---+--++++--+---+--++---+-+-++---------------+\\ | 
 |   || | |||||| || \\--+-+---+++---++-++-------+------++-++----+--+---+/||        |\\++--+----+-----+---+--++++--+---+--++---+-+-++---------------/| | 
 |   || | |||||| ||    | |   |||   || ||     /-+------++-++----+--+---+-++--------+-++--+----+-----+---+--++++--+---+--++--\\|/+-++------------\\   | | 
 |   || | |||||| ||    | |   |||   || ||     | |  /---++-++----+-\\|  /+-++--------+-++--+----+-----+-\\ |  ||||  |   |  ||  |||| ||            |   | | 
 |   || | |||||| ||    | |   |||   || ||     | |  |   || ||   /+-++--++-++--\\     | ||/-+----+-----+-+-+--++++--+---+--++--++++-++--\\         |   | | 
 |   |\\-+-++++++-++----+-+---+++---++-++-----+-+--+---++-++---++-++--++-++--+-----+-+++-+----+-----/ | |  ||||  |   |  ||  |||| ||  |         |   | | 
 |   |  | |||||| ||    | |   |||   || ||     | |  |   || ||   || ||  || ||  |     | ||| |    |       | |  ||||  |   | /++--++++-++--+--------\\|   | | 
 |   |  | |||||| ||    | |   |||   || ||  /--+-+--+---++-++---++-++--++-++--+-----+-+++-+----+--\\    | |  ||||  |   | |||  |||| ||  |        ||   | | 
 |   |  | |\\++++-++----+-+---+++---++-++--+--+-+--+---++-++---++-++--++-+/  |     | ||| |  /-+--+----+-+--++++--+---+-+++--++++-++--+----\\   ||   | | 
 |   |  | \\-++++-++----+-+---+++---++-++--+--+-+--+---++-++---++-++--++-+---+-----+-+/| |  | |  |/---+-+--++++--+---+-+++--++++-++-\\|    |   ||   | | 
 |   |  |   |||| \\+----+-+---+++---++-++--+--+-+--+---++-++---++-++--++-+---+-----+-+-+-+--+-+--++---+-+--+++/  |   | |||  |||| || ||    |   ||   | | 
 |   |  |   ||||  |    | |   |||   || ||  |  | |  |   || ||   || ||  || |   |     | | | |  | |  ||   | |  |||   |   | |||  |||| || ||    |   ||   | | 
 |   |  |   ||||  |    | |   |||  /++-++--+--+-+--+---++-++---++-++--++-+---+----\\| | | |  | |  ||   | |  |||   |   | |||  |||| || ||    |   ||   | | 
 |   |  \\---++++--+----+-+---/||  ||| ||  |  | |  |   || ||  /++-++--++-+\\  |    || | | |  | |  ||   | |  |||   |   | |||/-++++-++-++----+---++---+-+\\
 |   |      ||||  |    | |    ||  ||| ||  |  | |  |   || ||  ||| ||  || ||  |    || | | |  | |  ||   | | /+++---+---+\\|||| |||| || ||    |   ||   | ||
 |   |      ||||  |   /+-+----++--+++-++--+--+-+--+---++-++\\ ||| ||  || ||  | /--++-+-+-+-\\|/+--++---+-+-++++---+---++++++-++++-++-++----+---++--\\| ||
 |   \\------+++/  |   || |    ||  ||| ||/-+--+-+--+---++-+++-+++-++--++-++--+-+--++-+-+-+-++++--++---+-+-++++-\\ |   |||||| |||| || ||    |   ||  || ||
 |          |||   |   || |    ||  ||| ||| |  | |  |   || |||/+++-++--++-++--+-+--++-+-+-+-++++->++---+-+-++++-+-+---++++++-++++-++-++--\\ |   ||  || ||
 |          |||   |   || |    ||  ||| ||| \\--+-+--+---++-+++++++-++--++-++--+-+--++-+-+-+-++++--/|   | | |||| | |   |||||| |||| || ||  | |   ||  || ||
 |          |||  /+---++-+----++--+++-+++----+-+--+---++-+++++++-++--++-++--+-+--++-+-+-+-++++--\\|   | | |||| | |   |||||| |||| || ||  | |   ||  || ||
 |          |||  ||   || |    ||  ||| |||    | |  \\---++-+++++++-/|  || ||  | |  || | | | |\\++--++---+-+-++++-+-+---++++++-++++-++-++--+-/   ||  || ||
 |          |||  ||   || |    ||  ||v |||    | |      || |||||||  |  || ||  | |  || | | |/+-++--++---+-+-++++-+-+---++++++-++++-++-++-\\|     ||  || ||
 |          |||/-++---++-+----++--+++-+++----+-+------++-+++++++--+--++-++--+-+--++-+-+-+++-++--++---+-+-++++-+-+--\\|||||| ||||/++-++-++-\\   ||  || ||
 |          |||| ||   || |   /++--+++-+++----+-+------++-+++++++-\\|  \\+-++--+-+--++-+-+-+++-++--++---/ | |||| | |  ||||||| ||||||| || || |   ||  || ||
 |          |||| ||   || |   |||  ||| \\++----+-+------++-+++++++-++---+-++--+-+--++-+-+-+++-++--++-----+-++++-+-+--+++++++-+++/||| || || |   ||  || ||
 |          |||| ||   || |   |||  |||  ||    | |      || ||||||| ||   | ||  | |  || | | ||| ||  ||     | |||| | |  ||||||| ||| ||| || || |   ||  || ||
 |          |||| || /-++-+---+++--+++--++----+-+------++-+++++++-++---+-++--+-+--++-+-+-+++-++--++-----+-++++-+-+-\\||||||| ||| ||| || || |   ||  || ||
 |          |||| || | || |   |||  |||  ||    |/+------++-+++++++-++---+-++--+\\|  || | | ||| ||/-++-----+-++++-+-+-++++++++-+++-+++\\|| || |   ||  || ||
 |  /-------++++-++-+-++-+---+++--+++--++----+++------++-+++++++-++-\\ | ||  |||  || | | ||| ||| ||     | |||| | | |||||||| ||| |||||| || |   ||  || ||
 |  |       |||| || | || |   |||  |||  ||    |||      || ||||||| || | | ||  |||  || | | ||| ||| ||     | |||| | | |||||||| ||| |||||| || |   ||  || ||
 |  |       |||| || | || |   |||  |||  ||    |||      || ||||||| || | | ||  |||  || | | ||| ||| ||     | |||| | |/++++++++-+++-++++++-++-+-\\ ||  || ||
 |  |       |||| || | || |   |||  |||  ||    |||      || ||||||| || | ^ ||  |||  || | | ||| ||| ||     | |||| | |||||||||| ||| |||||| || | | ||  || ||
 |  |       |||| || | ||/+---+++--+++--++----+++\\     || ||||||| || | | ||  |||  || | | |^| ||| |\\-----+-++++-+-++++++++++-+++-++++/| || | | ||  || ||
 |  |       |||| || | ||||   |||  ||\\--++----++++-----+/ ||||||| || | | ||  |||  || | | ||| ||| |      | |||| | |||||||||| ||| |||| | || | | ||  || ||
 |  |  /----++++-++-+-++++---+++--++---++----++++-----+--+++++++-++-+-+-++--+++\\ || | | ||| ||| |      | |||| | |||||||||\\-+++-++++-+-++-+-+-++--++-+/
 |  |  |    |||| || | ||||   |||  ||   ||    ||||     |  ||||||| || | | ||  |||| || | \\-+++-+++-+------+-++++-+-+++++++++--+++-++++-/ || | | ||  || | 
 |  |  |    |||| || | ||||   |||  ||   ||    ||||     |  ||||||| || |/+-++--++++-++-+---+++-+++-+------+-++++-+-+++++++++--+++\\||||   || | | ||  || | 
 |  |  |    |||| |\\-+-++++---+++--++---++----++++-----+--/|||||| || ||| ||  |||| || |   ||| ||| |      | |||| | |||||||||  |^||||||   || | | ||  || | 
 |  |  |    |||| |  | ||||   |||/-++---++----++++-----+---++++++-++-+++-++--++++-++-+---+++-+++-+----\\ | |||| | |||||||||  ||||||||   || | | ||  || | 
 |  |  |    |||| |  | ||||   |||| ||   ||    ||||     |   |||||| || ||| ||  |||| || |   ||| \\++-+----+-+-++++-+-+++++++++--++++++++---++-+-+-++--/| | 
 |  |  |  /-++++-+--+-++++---++++-++---++----++++-----+---++++++-++-+++-++-\\|||| || |   |||  || |    | | |||| | |||||||||  ||||||||   || | | ||   | | 
 |  |  |  | |||| |  | ||||   |||| ||   ||    ||||     |   |||||| || ||| || ||||| || |   |||  || |    | | |||| | \\++++++++--++++++/|   || | | ||   | | 
 |  |  |  | |||| |  | ||||   |||| ||   ||    ||||     |  /++++++-++-+++-++-+++++-++-+---+++--++\\|    | | |||| |  ||||||||  |||||| |   || | | ||   | | 
 |  |  |  | |||| |  | ||||   |||| ||   ||    ||||     |  |||||||/++-+++-++-+++++-++-+---+++--++++----+-+\\|||| |  ||||||||  |||||| |   || | | ||   | | 
 |  |  | /+-++++-+--+-++++---++++-++---++----++++-----+--++++++++++-+++-++-+++++-++-+-\\ |||  ||||    | |||||| |  ||||||||  |||||| |   || | | ||   | | 
 |  |  | || |||| |  | ||||   |||| ||   \\+----++++-----+--++++++++++-+++-++-+++++-++-+-+-+++--++++----+-++++++-+--++++++/|  |||||| |   || | | ||   | | 
 |  |  | || |\\++-+--+-+/||   |||| ||    |    ||||     |  |||||||||| ||\\-++-+++++-++-+-+-+++--++++----+-++++/| |  |||||| |  |||||| |   || | | ||   | | 
 |  |  | || | || |  | | ||   |||| ||    |    ||||     |  |||||\\++++-++--++-+/||| || | |/+++--++++----+-++++-+-+--++++++-+--++++++-+-\\ || | | ||   | | 
 |/-+--+-++-+-++-+--+-+\\||   |||| ||    |    ||||     |  ||||| |||| ||  || | ||| || | |||||  ||||    | |||\\-+-+--++++++-+--++++++-+-+-++-+-+-++---+-/ 
 || |  | || | || |  | ||||   |||| ||    |    ||||     |  ||||| |||| ||  || | ||| || | |||||  ||||    | |||/-+-+--++++++-+--++++++-+-+-++-+\\| ||   |   
 || |  | || | || |  | ||||   |||| ||    | /--++++-----+--+++++-++++-++--++-+-+++-++-+-+++++--++++----+-++++-+-+--++++++-+--++++++-+-+-++-+++-++---+--\\
 || |  | || | || |  | \\+++---++++-++----+-+--++++-----+--++/|| |||| ||  || | |\\+-++-+-++++/  ||||    | |||| | |  |||||| |  |||||| | | || ||| ||   |  |
 || |  | || | || |  |  |||   |||| ||    | |  ||||   /-+--++-++-++++-++--++-+-+-+-++-+-++++---++++----+-++++-+-+--++++++-+-\\|||||| | | || ||| ||   |  |
 || |  | || \\-++-+--+--+++---++/| ||    | |  ||||   | |  || || |||| ||  || | | | || | ||||  /++++----+-++++-+-+--++++++-+-+++++++-+-+-++\\||| ||   |  |
 || |  | ||   || |  |  |||   || | |\\----+-+--++++---+-+--++-++-++++-++--/| | | | ||/+-++++--+++++----+-++++-+-+--++++++-+-+++++++\\| | |||||| ||   |  |
 || |  | ||   || |  |  |||   || | |     | |  ||||   | |  || || |||| ||   | | | | |||| ||||  |||||    | |||| | |  |||||| | ||||||||| | |||||| ||   |  |
 || |  | ||   || |  \\--+++---++-+-+-----+-+--++++---+-+--++-++-++++-++---+-+-+-+-++++-++++--+++++----+-++++-+-+--+/|||| | ||||||||| | |||||| ||   |  |
 || |  | ||  /++-+-----+++\\  || | \\-----+-+--++++---+-+--++-++-++++-++---+-+-+-+-/||| ||||  |||||    | |||| | |  | |||| | ||||||||| | |||||| ||   |  |
 || |  | ||  |||/+-----++++--++-+----\\  | |  ||||   | |  || || |||| ||   | | | |  ||| ||||  |||||    | |||| | |  | |||\\-+-+++++++++-+-++++++-/|   |  |
 || |  | ||  ||\\++-----++++--++-+----+--+-+--++++---+-+--++-++-++++-++---+-+-+-+--+++-++++--+++++----+-++++-+-+--+-/||  | ||||||||| | ||||||  |   |  |
 || |  ^ ||  || ||     |||| /++-+----+--+-+\\ ||||   | |  || || |||| ||   | | | |  ||| ||||  ||\\++----+-++++-+-+--+--++--+-++++++++/ | ||||||  |   |  |
 || |  | ||  || ||     |||| ||| |    |  | || ||||   \\-+--++-++-++++-++---+-+-+-+--+++-++++--++-++----+-++++-+-+--+--++--+-/|||||||  | ||||||  |   |  |
 || |  | ||/-++-++-----++++\\||| |    |  | || ||||     |  || || |||| |\\---+-+-+-+--+++-++++--++-++----+-++++-+-+--+--++--+--+++/|||  | ||||||  |   |  |
 || |  | ||| |\\-++-----++++++++-+----+<-+-++-++++-----/  || || |||| |    | | | |  ||| ||||  || ||    | ||\\+-+-+--+--+/  |  ||| |||  | v|||||  |   |  |
 \\+-+--+-+++-+--++-----++++++++-+----+--+-++-++++--------++-++-++++-+----+-+-+-+--++/ ||||  || ||/---+-++-+-+-+--+--+---+--+++-+++--+-++++++\\ |   |  |
  | |  | ||| |  ||     |||||||| |    |  | || ||||        || || |||| |    | | | |  |\\--++++--++-+++---+-++-+-+-+--+--+---+--+++-++/  | ||||||| |   |  |
  | | /+-+++-+--++-----++++++++-+----+--+-++-++++----\\   || || \\+++-+----+-+-+-+--+---++++--++-+++---+-++-+-+-+--+--+---+--+/| ||   | ||||||| |   |  |
  | | || |||/+--++-----++++++++-+----+--+-++\\||||    |   || \\+--+++-+----+-+-+-+--+---++++--++-+++---+-++-+-+-+--+--+---+--+-+-++---+-+/||||| |   |  |
/-+-+-++-+++++--++-----++++++++-+----+--+-+++++++----+---++-\\|  \\++-+----+-+-+-+--+---++++--++-+++---+-+/ | | |  |  |   |  | | ||   | | ||||| |   |  |
| | | || |||||  ||     |||||||| |    |  | |||||||    |   || ||   || |    | | | |  \\---++++--++-+++---+-+--+-+-+--+--+---/  | | ||   | | ||||| |   |  |
| | | || |||||  ||     |||||||| |    |  | |||||||    |   || ||   ||/+----+-+-+-+------++++-\\|\\-+++---+-+--+-+-+--+--+------+-+-++---+-+-+++++-+---/  |
| | | || |||||  ||     |||||||| |    |  | |||||||/---+---++-++---++++----+-+-+-+------++++-++--+++---+-+--+-+-+--+--+------+-+-++->-+-+-+++++-+\\     |
| | | || |||||  ||     |||||||| |    |  | ||||||||   |   || ||   ||||    |/+-+-+------++++-++--+++---+-+--+-+-+--+--+------+-+-++---+-+\\||||| ||     |
| | | || |||||/-++-----++++++++-+----+--+-++++++++---+---++-++---++++-\\  ||| |/+------++++-++--+++---+-+--+-+-+--+--+------+-+-++---+-+++++++-++----\\|
| | | || |||||| ||     |||||||| |    |  | ||||||||   |   || ||   |||| |  ||| |||      |||| ||  |||   | |  | | |  |  |      | | ||   | ||||||| ||    ||
| | \\-++-++++++-++-----++++++++-+----+--+-++++++++---+---++-++---+++/ |  ||| |||      |||| ||  |||   | |  | | |  |  |      | | ||   | ||||||| ||    ||
| |   || |||||| ||     |||||||\\-+----+--+-++++++++---+---++-++---+++--+--+++-+++------++++-++--+++---+-/  | | |  |  |      | | ||   | ||||||| ||    ||
| |   || |||||| ||     |||||||  |    |  | \\+++++++---+---++-++---+++--+--+++-+++------++++-++--+++---+----+-+-+--+--+------+-+-++---+-+++++++-++----+/
| |   || |||||| ||     |||||||  |    |  |  |||||||   |   || ||   |||  |  ||| |||      |||| ||  |||   |    | | |  |  |      | | ||   | ||||||| ||    | 
| |   || |||||| ||     |||||||  |    |  |  |||||||   |   || ||   |||  |  ||| ||| /----++++-++--+++---+----+-+-+--+--+------+-+-++--\\| ||||||| ||    | 
| |   || |||||| ||     |||||||  |    |  |  |||\\+++---+---++-++---+++--+--+++-/|| |    |||| ||  |||   |    | | |  |  |      | | ||  || ||||||| ||    | 
| |   || |||||| ||     |||||||  |    |  |  ||| |||   |   |\\-++---+++--+--+++--++-+----++++-++--+++---+----+-+-+--+--+------+-+-+/  || ||||||| ||    | 
| |   || |||||| ||     |||||||  |    |  |  ||| |||   |   |  ||   |||  |  |||  || |    |||| ||  |||  /+----+-+-+--+--+------+-+-+--\\|| ||||||| ||    | 
| |   || |||||| ||     |||||||  |    |  |  ||| |||   |   \\--++---+++--+--+++--++-+----++++-++--/||  ||    | | |  |  |  /---+-+-+--+++-+++++++-++\\   | 
| |   \\+-++++++-++-----+++++++--+----+--+--+++-+++---/      ||   |||  |/-+++--++-+----++++-++---++-\\||    | | |  |  |  |   | | \\--+++-+++/||| |||   | 
| |    | |||||| ||     |||||||  |    |  |  ||| |||          ||   |||  || |||  || |    v||| ||   || |||   /+-+-+--+--+--+---+-+\\   ||| ||| ||| |||   | 
| |    | |||||| ||     |||||||  |    |  \\--+++-+++----------++---+++--++-+++--++-+----++++-++---++-+++---++-+-/  |  |  |   | ||   ||| ||| ||| |||   | 
| \\----+-++++++-++-----/|\\++++--+----+-----+++-+++----------++---+/|  || |||  || |    ||||/++---++-+++---++-+---\\|  |  |   | ||   ||| ||| ||| |||   | 
|      | |||||| \\+------+-++++--+----/     ||| |||          ||   | |  || |||  || |    |||||||   || |||   || |   ||  |  |   | ||   ||| ||| ||| |||   | 
|      | ||||||  |      | ||||  |          ||| |||          ||   | |  || |||  || |    |||||||   || |||   || |   ||  |  |   | ||   ||| ||| ||| |||   | 
|      | ||||||  |    /-+-++++--+------\\   ||| ||v          ||   | |  || |||  || |    |||||||   |\\-+++---++-+---++--+--+---+-++---+++-+++-++/ |||   | 
|      | ||||||  |    | | ||||  |      |   ||| |||          ||   | |  || |||  || |    ||\\++++---+--+++---++-/   ||  |  |   | ||   ||| ||| ||  |||   | 
|      | ||||||  |    | | ||||  |      |   ||| |||          ||   | |  || |||  \\+-+----++-++++---+--+++---++-----++--+--+---+-++---+++-+++-++--+++---/ 
|      \\-++++++--+----+-+-++++--+------+---+++-+++----------++---+-+--++-+++---/ |    || ||||   |  |||   ||     ||  |  |   | ||   ||| ||| ||  |||     
|        ||||||  |    | | ||||  |      |   ||\\-+++----------++---+-+--++-+++-----+----++-++++---+--+++---++-----++--+--+---/ \\+---+++-+++-++--/||     
|     /--++++++--+----+-+-++++--+------+---++--+++\\         |\\---+-+--++-/||     |    || ||||   |  |||   \\+-----++--+--+------/   ||| ||| ||   ||     
|     |  ||||||  |    | | ||||  |      |   ||  ||||         |    | |  ||  ||     |    || ||||   |  |||    |     ||  |  |          ||| ||| ||   ||     
|     |  \\+++++--+----+-+-++++--+------+---++--++++---------+----+-+--++--++-----+----/| ||||   |  |||    \\-----++--+--+----------+++-+++-/|   ||     
|     |/--+++++--+----+-+-++++--+------+---++-\\\\+++---------+----+-+--++--++-----+-----+-++++---+--+++----------++--/  |          ||| |||  |   ||     
|     ||  |||||  |    | | ||||  \\------+---++-+-+++---------+----+-+--++--++-----+-----+-++++---+--++/          ||     |          ||| |||  |   ||     
|     ||  |||||  |    | | ||||         |   || | |||         |    | |  ||  ||     |     | ||||   |  ||           ||     |          ||| |||  |   ||     
|     ||  |||||  |    | | ||||         |   || | |||         |    | |  ||  ||     |     | ||||   |  ||/----------++-----+------\\   ||| |||  |   ||     
|     ||  |||||  |    | | ||||         |   || | |||         |    | \\--++--++-----+-----+-++/|   |  |||          ||     |      |   ||| |||  |   ||     
|/----++--+++++--+----+-+-++++---------+---++-+-+++---------+----+----++--++-----+\\    | \\+-+---+--+++----------++-----+------+---+++-/||  |   ||     
||    ||  |||||  |    \\-+-++++---------/   || | |||         |    |    ||  ||     ||    |  | |   |  |||          ||     |      |   |||  ||  |   ||     
||    ||  |||||  |      | ||||             || | |||         |    |    ||  ||     ||    |  | |   |  |||          ||     \\------+---+++--++--+---+/     
||    ||  |||||  |      | ||\\+-------------/| | |||         |    |    ||  || /---++----+--+-+---+--+++---\\      ||            |   |||  ||  |   |      
||    |\\--+++++--+------+-++-+--------------+-/ |||         |    |    ||  || |   ||    |  | |   |  |||   |      ||            |   |||  ||  |   |      
||    |   |||||  |      | || |  /-----------+\\  |\\+---------+----+----++--++-+---++----+--+-+---+--+++---+------++------------+---+++--++--+---/      
||    |   |\\+++--+------+-+/ |  |   /-------++--+-+--\\      |    |    ||  || |   ||    |  | |   |  |||   |      ||            |   |||  ||  |          
||    |  /+-+++--+------+-+--+--+---+-------++--+-+--+------+----+----++--++-+---++----+--+-+---+--+++\\  |      ||            |   |||  ||  |          
||    |  || |||  |      | |  |  |   |       ||  | |  |      |    |    ||  || |   ||    |  | |   |  ||\\+--+------++------------/   |||  |^  |          
||    |  || |||  |      | |  \\--+---+-------++--+-+--+------+----/    ||  || |   ||    |  | |   |  || |  |      ||                |||  ||  |          
||    |  || |||  |      | |     |   |       ||  | |  |      |         ||  || |   ||    |  | |   |  || |  |      ||                |||  ||  |          
||    \\--++-+++--+------+-+-----+---+-------++--+-/  |      |         ||  || |   ||    \\--+-+---+--++-+--+------++----------------++/  ||  |          
||       || |||  |      \\-+-----+---+-------++--/    |      |         ||  || |   ||       | |   |  || |  |      |\\----------------++---++->/          
||       || ||\\--+--------+-----+---+-------++-------+------+-<-------/|  || |   ||       | \\---+--++-+--+------+-----------------++---+/             
||       |\\-++---+--------+-----+---+-------++-------+------+----------+--+/ |   ||       |     |  || |  |      |                 ||   |              
\\+-------+--++>--+--------+-----+---+-------++-------+------/          |  |  \\---++-------+-----+--++-+--/      |                 ||   |              
 |       |  ||   \\--------+-----+---+-------++-------+-----------------+--+------++-------+-----/  || |         |                 ||   |              
 |       |  \\+------------+-----+---+-------/|       |                 |  \\------++-------+--------++-+---------+-----------------++---/              
 |       |   \\------------/     \\---+--------/       |                 |         \\+-------+--------++-+---------+-----------------+/                  
 |       |                          |                |                 \\----------+-------+--------/| |         |                 |                   
 \\-------+--------------------------+----------------+----------------------------/       |         \\-+---------+-----------------/                   
         \\--------------------------+----------------+------------------------------------+-----------/         |                                     
                                    \\----------------/                                    \\---------------------/                                     `;

  part2(input);